{% extends 'custom-admin/base.html' %}
{% load static %}
{% block content %}

<section class="manageActivitiesPage managepadding manageallpage">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <!-- TOP CONTENT START -->
                <div class="topContent">
                    <h2 class="H2Heading">Manage Social Links</h2>
                     <button class="topContentButton" data-bs-toggle="modal" data-bs-target="#addSocialLinksModal">
                        <i class="fa fa-plus" aria-hidden="true"></i>
                        Add Social Link
                    </button>
                </div>
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-{% if message.tags == "error" %}danger{% else %}{{message.tags}}{% endif %} alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    {% endfor %}
                {% endif %}

                {% comment %} <!-- SEARCH AND FILTER -->
                <div class="row mb-4">
                    <div class="col-md-12">
                        <form method="GET" class="mb-4">
                            <div class="input-group">
                                <input type="search" class="customInput searchTable" name="search" 
                                       placeholder="Search by title or content" 
                                       value="{{ search_query }}">
                                <div class="input-group-append">
                                    <button class="btn btn-primary" style="display:none" type="submit">Search</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div> {% endcomment %}

                <!-- TABLE START -->
                <div class="scrollableTable">
                    <table cellpadding="1" cellspacing="1">
                        <tr >
                            <th>ID</th>
                            <th>Facebook URL</th>
                            <th>Instagram URL</th>
                            <th>LinkedIn URL</th>
                            <th>Twitter URL</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                        <tbody>
                            {% if contents %}
                                {% for content in contents %}
                                <tr>
                                    <td>{{ content.id }}</td>
                                    <td>{{ content.facebook }}</td>
                                    <td>{{ content.instagram }}</td>  <!-- Add this line -->
                                    <td>{{ content.linkedin }}</td>
                                    <td>{{ content.twitter }}</td>
                                    <td>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input toggle-status" 
                                                   type="checkbox" 
                                                   {% if content.is_active %}checked{% endif %}
                                                   disabled>
                                        </div>
                                    </td>
                                    <td>
                                        <button class="tableActionBtn edit-content" 
                                                data-content-id="{{ content.id }}"
                                                data-facebook="{{ content.facebook }}"
                                                data-instagram="{{ content.instagram }}"
                                                data-linkedin="{{ content.linkedin }}"
                                                data-twitter="{{ content.twitter }}"
                                                data-is-active="{{ content.is_active|lower }}"
                                                data-edit-url="{% url 'admin_panel:social_links_edit' content.id %}">
                                            <i class="fa fa-edit"></i>
                                        </button>
                                         <button class="tableActionBtn delete-content" 
                                                data-delete-url="{% url 'admin_panel:social_links_delete' content.id %}">
                                            <i class="fa fa-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="8" class="text-center">No content found.</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>

                    {% comment %} <!-- PAGINATION -->
                    <div class="tablePagination">
                        <nav aria-label="Page navigation">
                            <ul class="pagination">
                                {% if contents.has_previous %}
                                    <li class="page-item">
                                        <a class="page-link" href="?page={{ contents.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}">
                                            <span aria-hidden="true">&laquo;</span>
                                        </a>
                                    </li>
                                {% endif %}

                                {% for num in contents.paginator.page_range %}
                                    <li class="page-item {% if contents.number == num %}active{% endif %}">
                                        <a class="page-link" href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}">{{ num }}</a>
                                    </li>
                                {% endfor %}

                                {% if contents.has_next %}
                                    <li class="page-item">
                                        <a class="page-link" href="?page={{ contents.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}">
                                            <span aria-hidden="true">&raquo;</span>
                                        </a>
                                    </li>
                                {% endif %}
                            </ul>
                        </nav>
                    </div> {% endcomment %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Edit Content Modal -->
<div class="modal fade customModal addDataModal" id="editSocialLinksModal" tabindex="-1" aria-labelledby="editSocialLinksModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="H2Heading">Edit Social Media Links </h6>
                <button type="button" class="hideClose_Modal" data-bs-dismiss="modal">
                    <img src="{% static 'admin/images/close.png' %}" alt="" class="img-fluid">
                </button>
            </div>

            <div class="modal-body">
                <form method="post" id="editSocialLinksForm">
                    {% csrf_token %}
                    <div class="row row-gap-4">
                        <div class="col-md-12">
                            <label class="inputLabel">Facebook</label>
                            <input type="text" name="facebook" id="edit_facebook" class="customInput" value="{{ social_link.facebook }}" placeholder="Enter Title">
                        </div>

                        <div class="col-md-12">
                            <label class="inputLabel">Instagram</label>
                            <input type="text" name="instagram" id="edit_instagram" class="customInput" value="{{ social_link.instagram}}" placeholder="Enter Instagram URL">
                        </div>

                        <div class="col-md-12">
                            <label class="inputLabel">LinkedIn</label>
                            <input type="text" name="linkedin" id="edit_linkedin" class="customInput" value="{{ social_link.linkedin}}" placeholder="Enter LinkedIn URL">     
                        </div>
                        <div class="col-md-12">
                            <label class="inputLabel">Twitter</label>
                            <input type="text" name="twitter" id="edit_twitter" class="customInput" value="{{ social_link.twitter}}" placeholder="Enter Twitter URL">
                        </div>


                        <div class="col-md-12">
                            <label class="inputLabel">Status</label>
                            <div class="customSingleSelect">
                                <div class="select-icon">
                                    <i class="fa fa-angle-down selectIcon"></i>
                                    <select name="is_active" id="edit_status" class="icons_select2" single="single">
                                        <option value="true" {% if social_link.is_active %}selected{% endif %}>Active</option>
                                        <option value="false" {% if not social_link.is_active %}selected{% endif %}>Inactive</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Modal Footer -->
                        <div class="modalFooter">
                            <button type="button" class="customButton" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="customButton ms-2">Update</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Add Content Modal -->
<div class="modal fade customModal addDataModal" id="addSocialLinksModal" tabindex="-1" aria-labelledby="addSocialLinksModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="H2Heading">Add New Content</h6>
                <button type="button" class="hideClose_Modal" data-bs-dismiss="modal">
                    <img src="{% static 'admin/images/close.png' %}" alt="" class="img-fluid">
                </button>
            </div>

            <div class="modal-body">
                <form method="post" action="{% url 'admin_panel:social_links_add' %}">
                    {% csrf_token %}
                    <div class="row row-gap-4">
                        <div class="col-md-12">
                            <label class="inputLabel">Facebook</label>
                            <input type="text" name="facebook" class="customInput" placeholder="Enter Title" required>
                        </div>
                        <div class="col-md-12">
                            <label class="inputLabel">Instagram</label>
                            <input type="text" name="instagram" class="customInput" placeholder="Enter Instagram URL" required>
                        </div>
                        <div class="col-md-12">
                            <label class="inputLabel">LinkedIn</label>
                            <input type="text" name="linkedin" class="customInput" placeholder="Enter LinkedIn URL" required>
                        </div>
                        <div class="col-md-12">
                            <label class="inputLabel">Twitter</label>
                            <input type="text" name="twitter" class="customInput" placeholder="Enter Twitter URL" required>
                        </div>

                       

                        <div class="col-md-12">
                            <label class="inputLabel">Status</label>
                            <div class="customSingleSelect">
                                <div class="select-icon">
                                    <i class="fa fa-angle-down selectIcon"></i>
                                    <select name="is_active" class="icons_select2" single="single">
                                        <option value="true">Active</option>
                                        <option value="false">Inactive</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="modalFooter">
                            <button type="button" class="customButton" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="customButton ms-2">Create</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Delete Content Modal -->
<div class="modal fade customModal addDataModal" id="deleteSocailLinksModal" tabindex="-1" aria-labelledby="deleteSocailLinksModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content text-center" style="height: 340px;">
            <div class="modal-body">
                <img src="{% static 'admin/images/svg-icon/Delete.svg' %}" alt="">
                <form method="post" id="deleteSocialLinksForm">
                    {% csrf_token %}
                    <div class="row">
                        <div class="col-md-12 my-4">
                            <h2 class="H2Heading">Confirm Delete</h2>
                            <h5 class="H5Heading mt-3">Are you sure you want to delete this content? This action cannot be undone.</h5>
                        </div>

                        <div class="modalFooter">
                            <button type="button" class="customButton" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="customRedButton ms-3">Delete</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extrajs %}
<script>
$(document).ready(function() {
    // Edit content modal
    $('.edit-content').click(function() {
        var contentId = $(this).data('content-id');
        var title = $(this).data('title');
        var facebook = $(this).data('facebook');
        var instagram = $(this).data('instagram');
        var linkedin = $(this).data('linkedin');
        var twitter = $(this).data('twitter');
        var content = $(this).data('content');
        var isActive = $(this).data('is-active');
        var contentType = $(this).data('content-type');  // Add this line
        var editUrl = $(this).data('edit-url');


        $('#edit_title').val(title);
        $('#edit_facebook').val(facebook);
        $('#edit_instagram').val(instagram);
        $('#edit_linkedin').val(linkedin);
        $('#edit_twitter').val(twitter);
        $('#edit_content_type').val(contentType).trigger('change.select2');  // Add this line
        $('#edit_status').val(isActive ? "true" : "false").trigger('change.select2');
        $('#editSocialLinksModal').modal('show');
        $('#editSocialLinksForm').attr('action', editUrl);
    });
      // Delete content modal
    $('.delete-content').click(function() {
        var deleteUrl = $(this).data('delete-url');

        $('#deleteSocialLinksForm').attr('action', deleteUrl);
        $('#deleteSocailLinksModal').modal('show');
    });
});
</script>
{% endblock %}