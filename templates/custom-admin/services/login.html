{% load static %}
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Admin Login</title>

<!-- BOOTSTRAP CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">




<!-- Custom CSS -->
<link rel="stylesheet" href="{% static 'admin/css/page.css' %}" />
<link rel="stylesheet" href="{% static 'admin/css/default-element.css' %}" />
<link rel="stylesheet" href="{% static 'admin/css/button.css' %}" />
<link
  rel="shortcut icon"
  href="{% static 'admin/images/favicon.svg' %}"
/>

<!-- FONT AWESOME CDN -->
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">


<section class="loginPage">
  
  <div class="container">
    <div class="loginCard">
      <div class="customCard">
        <div class="mb-3 text-center">
           <img
            src="{% static 'admin/images/logo.svg' %}"
            
          /> 
          {% comment %} <h4 class="H2Heading">Despenser</h4> {% endcomment %}
        </div>
        <form
          class="manageLoginForm"
          method="post"
          action="{% url 'admin_panel:login' %}"
        >
          {% csrf_token %}
          <div class="mb-4">
            <input type="hidden" name="next" value="{{ next_url }}">
            <label class="inputLabel">email</label>
            <input
              type="email"
              class="customInput"
              name="email"
              placeholder="chrish@fff.in"
              required
            />
          </div>

          <div class="login1 password-toggle">
            <label for="" class="inputLabel">password</label>
            <input
              type="password"
              id="password"
              name="password"
              class="customInput"
              placeholder="************"
              required
            />
            <i class="fa fa-eye show-password"></i>
          </div>
          <div id="loginMessages">
            {% if messages %}
            {% for message in messages %}
                {% if not 'forgot_password_message' in message.extra_tags %}
                <div class="mt-3 alert alert-{% if message.tags == "error" %}danger alert-dismissible fade show{% else %}{{message.tags}} alert-dismissible fade show{% endif %}" role="alert">
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                {% endif %}
            {% endfor %}
            {% endif %}
          </div>
          <!-- MODAL START -->
          <div class="changePassword my-3">
            <button
              type="button"
              class="authmanagebtn"
              data-bs-toggle="modal"
              data-bs-target="#forgotPassword"
            >
              <a href="#" class="forgot">forgot password?</a>
            </button>
          </div>
          <!-- MODAL EXIT -->

          <button type="submit" class="customButton">Login</button>
        </form>
      </div>
    </div>
  </div>

  <div
    class="modal fade customModal addDataModal"
    id="forgotPassword"
    tabindex="-1"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h6 class="H2Heading">Forgot Password</h6>
          <label class="form-label"
            >We are here to help you, Enter the email id to get reset
            link</label
          >
          <button
            type="button"
            class="btn-close hideClose_Modal"
            data-bs-dismiss="modal"
            aria-label="Close"
          >
            <i class="fa fa-long-arrow-left" aria-hidden="true"></i>
          </button>
        </div>

        <div class="modal-body">
          {% comment %} <div class="row justify-content-center mt-3">
            <div class="col-lg-10 col-md-12"> {% endcomment %}
              <div class="row justify-content-center">
                <div class="col-lg-10 col-md-12">
                  <div id="forgotPasswordMessages">
                    {% if messages %}
                      {% for message in messages %}
                        {% if 'forgot_password_message' in message.extra_tags %}
                          <div class="alert alert-{% if 'error' in message.tags %}danger{% else %}{{ message.tags|cut:"forgot_password_message " }}{% endif %} alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                          </div>
                        {% endif %}
                      {% endfor %}
                    {% endif %}
                  </div>
                  <form method="post" action="{% url 'admin_panel:forgot_password' %}">
                    {% csrf_token %}
                    <input
                      type="email"
                      name="email"
                      class="customInput"
                      placeholder="Registered Email id"
                      required
                    />
                    <div class="mt-5 text-center">
                      <button type="submit" class="customButton">
                        Send Reset Link
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            {% comment %} </div>
          </div> {% endcomment %}
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Replace the scripts at the bottom with these -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script>
  $(document).ready(function () {
    // Existing password toggle code
    $(".show-password").click(function () {
      var passwordField = $("#password");
      var type = passwordField.attr("type");
      if (type === "password") {
        passwordField.attr("type", "text");
        $(this).removeClass("fa-eye").addClass("fa-eye-slash");
      } else {
        passwordField.attr("type", "password");
        $(this).removeClass("fa-eye-slash").addClass("fa-eye");
      }
    });

     // Show modal if there are forgot password messages
     {% if messages %}
     {% for message in messages %}
       {% if 'forgot_password_message' in message.extra_tags %}
         var forgotPasswordModal = new bootstrap.Modal(document.getElementById('forgotPassword'));
         forgotPasswordModal.show();
       {% endif %}
     {% endfor %}
   {% endif %}

    // Auto-hide alerts after 5 seconds
    setTimeout(function() {
      $('.alert').fadeOut('slow');
    }, 5000);    
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>